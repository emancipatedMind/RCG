function Range(first,second,reverse){var properties={};properties.reverse=reverse;if(first<second){properties.lo=first;properties.hi=second;}else{properties.lo=second;properties.hi=first;};this.rand=function(){var upper,lower,diff,vtr,fullcircle=360;if(properties.reverse){upper=properties.lo;lower=properties.hi;diff=fullcircle-properties.hi+properties.lo;vtr=(Math.floor(Math.random()*diff)+lower);if(vtr>fullcircle)vtr-=fullcircle;return vtr;};lower=properties.lo;upper=properties.hi-lower;return(Math.floor(Math.random()*upper)+lower);};this.getProperties=function(){return properties;};this.getLowerLimit=function(){return properties.lo;};this.getUpperLimit=function(){return properties.hi;};};function Color(instance){var properties={},upper,lower,reverse;if(typeof instance==='object'&&instance!==null){properties=instance;}else{upper=parseInt($('.hue .upper input').val());lower=parseInt($('.hue .lower input').val());reverse=upper<lower;properties.hue=Color.prototype.setter(upper,lower,reverse);upper=parseInt($('.sat .upper input').val());lower=parseInt($('.sat .lower input').val());properties.sat=Color.prototype.setter(upper,lower,false);upper=parseInt($('.lig .upper input').val());lower=parseInt($('.lig .lower input').val());properties.lig=Color.prototype.setter(upper,lower,false);};properties.hsl=(function(){var hslString="hsl("+properties.hue+",";hslString+=properties.sat+"%,";hslString+=properties.lig+"%)";return hslString;})();properties.rgb=(function(){var h=properties.hue/360;var s=properties.sat/100;var l=properties.lig/100;var r,g,b;if(s===0){r=g=b=Math.round(l*255);}else{var t,u;var hue2Component=function(hue){var vtr;if(hue<0)hue+=1;if(hue>1)hue-=1;if(hue<1/6)vtr=u+(t-u)*6*hue;else if(hue<1/2)vtr=t;else if(hue<2/3)vtr=u+(t-u)*(2/3-hue)*6;else vtr=u;return Math.round(vtr*255);};l<.5?t=l*(s+1):t=-1*l*s+s+l;u=2*l-t;r=hue2Component(h+1/3);g=hue2Component(h);b=hue2Component(h-1/3);};var rgbString="rgb("+r+","+g;rgbString+=","+b+")";return rgbString;})();properties.message=(function(){var info="This is the color "+properties.hsl;info+=" or,in RGB, "+properties.rgb+".";return info;})();if(properties.index===undefined){properties.index=Color.prototype.index;Color.prototype.index+=1;};this.getProperties=function(){return properties;};this.getMessage=function(){return properties.message;};this.getHSL=function(){return properties.hsl;};this.getRGB=function(){return properties.rgb;};this.getHue=function(){return properties.hue;};this.getSat=function(){return properties.sat;};this.getLig=function(){return properties.lig;};this.getIndex=function(){return properties.index;};this.getId=function(){return properties.id;};this.saveColor=function(jqObject){if(properties.id){jqObject.text("No need. Color already exists in database.");return 0;}var xhr=new XMLHttpRequest(),dts="h="+properties.hue;dts+="&s="+properties.sat;dts+="&l="+properties.lig;xhr.open("POST","./PHP/SaveColor.php");xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");xhr.setRequestHeader("Content-length",dts.length);xhr.onreadystatechange=function(){if(this.readyState===4&&this.status===200){var ContentTypeHeader=this.getResponseHeader("Content-type");if(ContentTypeHeader==="application/json"){var response=JSON.parse(this.responseText);var message="Request was sent successfully. The server ";message+="says the request "+response.text;jqObject.fadeOut(1000,function(){$(this).html(message);}).fadeIn(1000);if(response.success){properties.id=response.id;$('.check').css("visibility","visible");$('.func').html("delete");newColor(properties,true);}jqObject.fadeOut(3000,function(){$(this).text(properties.message);}).fadeIn(3000);}else jqObject.html(this.responseText);}};xhr.send(dts);};this.deleteColor=function(jqObject){if(!(properties.id)){jqObject.text("Color is not in database.");return 0;};var xhr=new XMLHttpRequest(),dts="id="+properties.id;xhr.open("POST","./PHP/DeleteColor.php");xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");xhr.setRequestHeader("Content-length",dts.length);xhr.onreadystatechange=function(){if(this.readyState===4&&this.status===200){var ContentTypeHeader=this.getResponseHeader("Content-type");if(ContentTypeHeader==="application/json"){var response=JSON.parse(this.responseText);var message="Request was sent successfully. The server ";message+="says the request "+response.text;jqObject.fadeOut(1000,function(){$(this).html(message);}).fadeIn(1000);if(response.success){properties.id=undefined;$('.check').css("visibility","hidden");$('.func').text("save");newColor(properties,true);};jqObject.fadeOut(3000,function(){$(this).text(properties.message);}).fadeIn(3000);}else jqObject.html(this.responseText);}};xhr.send(dts);};this.displayColor=function(options){var settings,hsl=properties.hsl,defaults={jqColorObject:$('.color'),jqInfoObject:$('.info'),jqFuncObject:$('.func'),jqCheckObject:$('.check'),};if(typeof options==='object'){settings=$.extend({},defaults,options);}else settings=defaults;settings.jqColorObject.css({backgroundColor:hsl,boxShadow:'inset 0px 0px 3px black'});settings.jqInfoObject.text(properties.message);var normalCSS={cursor:"pointer",backgroundColor:hsl,borderColor:hsl,color:"white"};var hoverCSS={cursor:"pointer",backgroundColor:"white",color:hsl};settings.jqFuncObject.css(normalCSS);settings.jqFuncObject.hover(function(){$(this).css(hoverCSS);},function(){$(this).css(normalCSS);});if(properties.id===undefined){settings.jqCheckObject.css("visibility","hidden");settings.jqFuncObject.text("save");}else{settings.jqCheckObject.css("visibility","visible");settings.jqFuncObject.text("delete");};};};Color.prototype={index:0,setter:function(upper,lower,reverse){var range=new Range(upper,lower,reverse);return range.rand();},};var colors=[],currentColor,safe=true;var valCheck=function(){if(!($(this))){return;}var settings={lower:$(this).data().lower,upper:$(this).data().upper};var value=$(this).val();var errorCSS={color:"hsl(349,91%,49%)",backgroundColor:"hsl(349,91%,29%)",fontWeight:"bold"};var normalCSS={color:"white",backgroundColor:"hsl(113,74%,30%)",fontWeight:"normal"};if(value.match(/\d{1,}/)&&!(value<settings.lower || value>settings.upper)){$(this).css(normalCSS);safe=true;}else{$(this).css(errorCSS);safe=false;};};var newColor=function(instance,skipArray){var newColor=new Color(instance);if(!(skipArray)){newColor.displayColor();colors.push(newColor);$('.next').css("visibility","hidden");}else colors[newColor.getIndex()]=newColor;currentColor=newColor;if(colors.length>1)$('.prev').css("visibility","visible");};$('.new').click(function(){if(!safe){var message="<span class='failure'>";message+="Double check the options. Someone is out of range.";message+="</span>";$('.info').html(message);if(currentColor){setTimeout(function(){currentColor.displayColor();},3000);}return;}newColor();});$('.func').click(function(){if(currentColor.getId()===undefined){currentColor.saveColor($('.info'));}else currentColor.deleteColor($('.info'));});var buttonSetup=function(options){var message="Need to pass jQuery object to function buttonSetup. ";message+="Either pass jQuery object exclusively or pass object with jqObject property ";message+="that is a jQuery object.";if(typeof options!=='object'){console.log(message);return;}var settings,defaults={hover:"white",hueU:360,hueL:0,satU:75,satL:25,lumU:75,lumL:25,};if(options instanceof $){settings=defaults;settings.jqObject=options;}else{if(!(options.jqObject instanceof $)){console.log(message);return;}settings=$.extend({},defaults,options);}var colorString=(function(){if(typeof settings.color==='string'){return settings.color;}var hue=new Range(settings.hueU,settings.hueL);var sat=new Range(settings.satU,settings.satL);var lum=new Range(settings.lumU,settings.lumL);var hslString="hsl("+hue.rand()+", ";hslString+=sat.rand()+"%, ";hslString+=lum.rand()+"%)";return hslString;})();var hoverCSS={backgroundColor:settings.hover,color:colorString};var normalCSS={backgroundColor:colorString,borderColor:colorString,color:settings.hover};settings.jqObject.css(normalCSS);settings.jqObject.hover(function(){$(this).css(hoverCSS);},function(){$(this).css(normalCSS);});};$('.prev').click(function(){currentColor=colors[currentColor.getIndex()-1];currentColor.displayColor();$('.next').css("visibility","visible");if(currentColor.getIndex()===0)$(this).css("visibility","hidden");});$('.next').click(function(){currentColor=colors[currentColor.getIndex()+1];currentColor.displayColor();$('.prev').css("visibility","visible");if(currentColor.getIndex()===colors.length-1)$(this).css("visibility","hidden");});$('.load').click(function(){$('.arrow').css("visibility","hidden");colors.length=Color.prototype.index=0;var dts="getcolors=true";var xhr=new XMLHttpRequest();xhr.open("POST","./PHP/GetColors.php");xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");xhr.setRequestHeader("Content-length",dts.length);xhr.onreadystatechange=function(){if(this.readyState===4&&this.status===200){var ContentTypeHeader=this.getResponseHeader("Content-type");if(ContentTypeHeader==="application/json"){var responseText=JSON.parse(this.responseText);for(var j=0 ; j<responseText.colors.length ; j+=1){newColor(responseText.colors[j]);};}else $('.info').html(this.responseText);}};xhr.send(dts);});buttonSetup({jqObject:$('.new'),color:"hsl(195,84%,32%)"});buttonSetup({jqObject:$('.load'),color:"hsl(195,84%,32%)"});$('.hue input[type="text"]').data({upper:359,lower:0});$('.sat input[type="text"]').data({upper:100,lower:0});$('.lum input[type="text"]').data({upper:100,lower:0});$('.control input[type="text"]').change(valCheck);$('.hue .lower input[type="text"]').val("0");$('.hue .upper input[type="text"]').val("359");$('.sat .lower input[type="text"]').val("25");$('.sat .upper input[type="text"]').val("100");$('.lig .lower input[type="text"]').val("25");$('.lig .upper input[type="text"]').val("75");
